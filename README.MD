# Granja de Patos API

##  Descri√ß√£o do Desafio

Este desafio consiste em uma **API REST desenvolvida em Java com Spring Boot** para gerenciar uma granja de patos, suas funcionalidades s√£o:

- Cadastro de Patos, Clientes e Vendedores
- Registro de Vendas, aplicando descontos para clientes eleg√≠veis
- Listagem de Patos vendidos
- Gera√ß√£o de relat√≥rios em Excel
- Ranking de Vendedores por n√∫mero de vendas ou valor total vendido

O sistema utiliza **SQL Server** como banco de dados, **Docker** para containeriza√ß√£o e **Apache POI** para relat√≥rios.

---

##  Tecnologias Utilizadas

- **Java 17**
- **Spring Boot**
- **Spring Data JPA / Hibernate**
- **SQL Server**
- **Apache POI** (relat√≥rios Excel)
- **Docker
- **DBeaver** (modelagem e gerenciamento do banco)
- **Git / GitHub** (versionamento)

---

## üóì Cronograma

| Etapa | Descri√ß√£o | Estimativa de Horas |
|-------|-----------|-------------------|
| 1 | Modelagem do Banco de Dados | 3h |
| 2 | Cria√ß√£o do Projeto Spring Boot + Configura√ß√£o Docker/DB | 2h |
| 3 | Implementar entidades e reposit√≥rios (JPA) | 4h |
| 4 | Implementar services e regras de neg√≥cio | 5h |
| 5 | Criar endpoints REST (controllers) | 4h |
| 6 | Testes e valida√ß√µes | 3h |
| 7 | Gera√ß√£o de relat√≥rios (Apache POI) | 3h |
| 8 | Dockeriza√ß√£o da aplica√ß√£o e documenta√ß√£o final | 2h |

---

##  Modelagem do Banco de Dados

### Entidades Principais

- **PATO**: armazena informa√ß√µes de cada pato, incluindo refer√™ncia √† m√£e (auto-relacionamento)
- **CLIENTE**: informa√ß√µes dos clientes e elegibilidade para desconto
- **VENDEDORES**: cadastro de vendedores
- **VENDA**: registro de vendas de patos

### Diagrama ER:

docs/diagramaer.png

### Script:

```sql

-- Tabela Patos
CREATE TABLE PATO (
ID INT IDENTITY(1,1),
NOME VARCHAR(100),
VALOR DECIMAL(10,2),
ID_MAE INT NULL,
CONSTRAINT PK_PATO_ID PRIMARY KEY (ID),
CONSTRAINT FK_MAE FOREIGN KEY (ID_MAE) REFERENCES PATO(ID)
);

-- Tabela Clientes
CREATE TABLE CLIENTE (
ID INT IDENTITY(1,1),
NOME VARCHAR(100) NOT NULL,
DESCONTO BIT NOT NULL,
CONSTRAINT PK_CLIENTE_ID PRIMARY KEY (ID)
);

-- Tabela Vendedores
CREATE TABLE VENDEDORES (
ID INT IDENTITY(1,1),
NOME VARCHAR(100) NOT NULL,
MATRICULA INT NOT NULL UNIQUE,
CPF VARCHAR(14) NOT NULL UNIQUE,
CONSTRAINT PK_VENDEDOR_ID PRIMARY KEY (ID)
);

-- Tabela de Vendas
CREATE TABLE VENDA (
ID INT IDENTITY(1,1),
ID_CLIENTE INT NOT NULL,
ID_VENDEDOR INT NOT NULL,
TOTAL_VENDA DECIMAL(10,2),
DESCONTO BIT DEFAULT 0,
DATA_VENDA DATETIME NOT NULL DEFAULT GETDATE()  
CONSTRAINT PK_VENDA_ID PRIMARY KEY (ID),
CONSTRAINT FK_VENDA_CLIENTE FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID),
CONSTRAINT FK_VENDA_VENDEDOR FOREIGN KEY (ID_VENDEDOR) REFERENCES VENDEDORES(ID)
);


--Tabela Rela√ß√£o N-N da venda de patos

CREATE TABLE PATO_VENDA (
ID_VENDA INT NOT NULL,
ID_PATO INT NOT NULL UNIQUE,

CONSTRAINT PK_VENDA_PATOS_ID PRIMARY KEY (ID_PATO, ID_VENDA),
CONSTRAINT FK_PATO_VENDA_PATO FOREIGN KEY (ID_PATO) REFERENCES PATO(ID),
CONSTRAINT FK_PATO_VENDA_VENDA FOREIGN KEY (ID_VENDA) REFERENCES VENDA(ID)

)

